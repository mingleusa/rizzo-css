---
import DocsLayout from '../../../../layouts/DocsLayout.astro';
import CodeBlock from '../../../../components/CodeBlock.astro';
import AddComponentTabs from '../../../../components/AddComponentTabs.astro';

const tableIdBasic = 'table-vanilla-basic';
const tableIdSort = 'table-vanilla-sort';
const tableIdFilter = 'table-vanilla-filter';
const tableIdPlain = 'table-vanilla-plain';
---

<DocsLayout title="Table — Vanilla" description="Data table with vanilla HTML. Same BEM and behavior as Astro: sorting, filtering, striped rows. Ensure Rizzo CSS is loaded.">
  <section>
    <h2>Table</h2>
    <p>Data table with the same BEM classes and behavior as the <a href="/docs/components/table">Astro Table</a>: <code>table</code>, <code>table__wrapper</code>, <code>table__table</code>, <code>table__caption</code>, <code>table__head</code>, <code>table__body</code>, <code>table__row</code>, <code>table__cell</code>, <code>table__cell--head</code>. Add <code>table--striped</code> for alternating rows, <code>table--sortable</code> for sortable headers, <code>table--filterable</code> for the filter input. Use <code>data-table-sortable="true"</code> and <code>data-table-filterable="true"</code> on the wrapper so the script below initializes sorting and filtering.</p>
    <AddComponentTabs componentName="Table" />
    <h3>Basic</h3>
    <p>Same as Astro: sortable column headers (click or Enter/Space) and optional filter input with icon.</p>
    <div class="example">
      <div class="example-title">Live example</div>
      <div class="table table--striped table--sortable table--filterable" data-table-sortable="true" data-table-filterable="true" data-table-id={tableIdBasic}>
        <div class="table__filter-wrap">
          <label for={`${tableIdBasic}-filter`} class="sr-only">Filter table</label>
          <span class="table__filter-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__filter-icon-svg icon" aria-hidden="true"><path d="M22 3H2l8 9.46V19l4 2v-8.54L22 3z" /></svg>
          </span>
          <input type="search" id={`${tableIdBasic}-filter`} class="table__filter" placeholder="Filter table…" aria-controls={tableIdBasic} data-table-filter autocomplete="off" />
        </div>
        <div class="table__wrapper">
          <table class="table__table" id={tableIdBasic}>
            <caption class="table__caption">Sample data</caption>
            <thead class="table__head">
              <tr class="table__row">
                <th class="table__cell table__cell--head" scope="col" data-column-index="0" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="0" aria-label="Sort by Name">
                    <span class="table__cell-content">Name</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
                <th class="table__cell table__cell--head" scope="col" data-column-index="1" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="1" aria-label="Sort by Role">
                    <span class="table__cell-content">Role</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
                <th class="table__cell table__cell--head" scope="col" data-column-index="2" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="2" aria-label="Sort by Status">
                    <span class="table__cell-content">Status</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
              </tr>
            </thead>
            <tbody class="table__body">
              <tr class="table__row" data-row-index="0"><td class="table__cell" data-column-key="name">Alice</td><td class="table__cell" data-column-key="role">Developer</td><td class="table__cell" data-column-key="status">Active</td></tr>
              <tr class="table__row" data-row-index="1"><td class="table__cell" data-column-key="name">Bob</td><td class="table__cell" data-column-key="role">Designer</td><td class="table__cell" data-column-key="status">Active</td></tr>
              <tr class="table__row" data-row-index="2"><td class="table__cell" data-column-key="name">Carol</td><td class="table__cell" data-column-key="role">Manager</td><td class="table__cell" data-column-key="status">Away</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <h3>With sorting (number column)</h3>
    <p>Sortable column headers: click or Enter/Space. Set <code>data-type="number"</code> on <code>th</code> for numeric sort.</p>
    <div class="example">
      <div class="example-title">Live example</div>
      <div class="table table--striped table--sortable" data-table-sortable="true" data-table-id={tableIdSort}>
        <div class="table__wrapper">
          <table class="table__table" id={tableIdSort}>
            <caption class="table__caption">Scores</caption>
            <thead class="table__head">
              <tr class="table__row">
                <th class="table__cell table__cell--head" scope="col" data-column-index="0" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="0" aria-label="Sort by Name">
                    <span class="table__cell-content">Name</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
                <th class="table__cell table__cell--head" scope="col" data-column-index="1" data-sortable="true" data-type="number" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="1" aria-label="Sort by Score">
                    <span class="table__cell-content">Score</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
                <th class="table__cell table__cell--head" scope="col" data-column-index="2" data-sortable="true" data-type="number" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="2" aria-label="Sort by Level">
                    <span class="table__cell-content">Level</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
              </tr>
            </thead>
            <tbody class="table__body">
              <tr class="table__row" data-row-index="0"><td class="table__cell" data-column-key="name">Alice</td><td class="table__cell" data-column-key="score">92</td><td class="table__cell" data-column-key="level">3</td></tr>
              <tr class="table__row" data-row-index="1"><td class="table__cell" data-column-key="name">Bob</td><td class="table__cell" data-column-key="score">87</td><td class="table__cell" data-column-key="level">2</td></tr>
              <tr class="table__row" data-row-index="2"><td class="table__cell" data-column-key="name">Carol</td><td class="table__cell" data-column-key="score">95</td><td class="table__cell" data-column-key="level">4</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <h3>With filter</h3>
    <p>Filter input above the table: rows are shown/hidden by matching text in any cell.</p>
    <div class="example">
      <div class="example-title">Live example</div>
      <div class="table table--striped table--sortable table--filterable" data-table-sortable="true" data-table-filterable="true" data-table-id={tableIdFilter}>
        <div class="table__filter-wrap">
          <label for={`${tableIdFilter}-filter`} class="sr-only">Filter table</label>
          <span class="table__filter-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__filter-icon-svg icon" aria-hidden="true"><path d="M22 3H2l8 9.46V19l4 2v-8.54L22 3z" /></svg>
          </span>
          <input type="search" id={`${tableIdFilter}-filter`} class="table__filter" placeholder="Search…" aria-controls={tableIdFilter} data-table-filter autocomplete="off" />
        </div>
        <div class="table__wrapper">
          <table class="table__table" id={tableIdFilter}>
            <caption class="table__caption">Filterable list</caption>
            <thead class="table__head">
              <tr class="table__row">
                <th class="table__cell table__cell--head" scope="col" data-column-index="0" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="0" aria-label="Sort by Name">
                    <span class="table__cell-content">Name</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
                <th class="table__cell table__cell--head" scope="col" data-column-index="1" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="1" aria-label="Sort by Role">
                    <span class="table__cell-content">Role</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
                <th class="table__cell table__cell--head" scope="col" data-column-index="2" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="2" aria-label="Sort by Status">
                    <span class="table__cell-content">Status</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
              </tr>
            </thead>
            <tbody class="table__body">
              <tr class="table__row" data-row-index="0"><td class="table__cell" data-column-key="name">Alice</td><td class="table__cell" data-column-key="role">Developer</td><td class="table__cell" data-column-key="status">Active</td></tr>
              <tr class="table__row" data-row-index="1"><td class="table__cell" data-column-key="name">Bob</td><td class="table__cell" data-column-key="role">Designer</td><td class="table__cell" data-column-key="status">Active</td></tr>
              <tr class="table__row" data-row-index="2"><td class="table__cell" data-column-key="name">Carol</td><td class="table__cell" data-column-key="role">Manager</td><td class="table__cell" data-column-key="status">Away</td></tr>
              <tr class="table__row" data-row-index="3"><td class="table__cell" data-column-key="name">Dave</td><td class="table__cell" data-column-key="role">Developer</td><td class="table__cell" data-column-key="status">Active</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <h3>Without stripes</h3>
    <div class="example">
      <div class="example-title">Live example</div>
      <div class="table table--sortable" data-table-sortable="true" data-table-id={tableIdPlain}>
        <div class="table__wrapper">
          <table class="table__table" id={tableIdPlain}>
            <caption class="table__caption">Plain table</caption>
            <thead class="table__head">
              <tr class="table__row">
                <th class="table__cell table__cell--head" scope="col" data-column-index="0" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="0" aria-label="Sort by A">
                    <span class="table__cell-content">A</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
                <th class="table__cell table__cell--head" scope="col" data-column-index="1" data-sortable="true" data-type="string" aria-sort="none">
                  <button type="button" class="table__sort-trigger" data-column-index="1" aria-label="Sort by B">
                    <span class="table__cell-content">B</span>
                    <span class="table__sort-icon" aria-hidden="true">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="table__sort-icon-svg icon" aria-hidden="true"><path d="m7 15 5 5 5-5" /><path d="m7 9 5-5 5 5" /></svg>
                    </span>
                  </button>
                </th>
              </tr>
            </thead>
            <tbody class="table__body">
              <tr class="table__row" data-row-index="0"><td class="table__cell" data-column-key="a">1</td><td class="table__cell" data-column-key="b">2</td></tr>
              <tr class="table__row" data-row-index="1"><td class="table__cell" data-column-key="a">3</td><td class="table__cell" data-column-key="b">4</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <h3>Features</h3>
    <ul>
      <li><strong>Accessible</strong> — Semantic <code>&lt;table&gt;</code>, <code>&lt;caption&gt;</code>, <code>scope="col"</code>, <code>aria-sort</code> on sortable headers, keyboard (Enter/Space) to sort.</li>
      <li><strong>Sorting</strong> — Sortable column headers with Sort icon; click to sort ascending/descending; <code>data-type="number"</code> on <code>th</code> for numeric sort.</li>
      <li><strong>Filtering</strong> — Optional filter input with Filter icon; rows shown/hidden by matching text in any cell.</li>
      <li><strong>Striped rows</strong> — Add <code>table--striped</code> for alternating row background.</li>
      <li><strong>Responsive</strong> — Table wrapper scrolls horizontally on small screens.</li>
    </ul>
    <p><strong>Astro / Svelte:</strong> <a href="/docs/components/table">Astro</a> · <a href="/docs/svelte/components/table">Svelte</a></p>
    <p><a href="/docs/vanilla/components">← Back to Vanilla components</a></p>
  </section>
</DocsLayout>

<script is:inline>
  (function() {
    function init() {
      document.querySelectorAll('[data-table-sortable="true"], [data-table-filterable="true"]').forEach(function(wrapper) {
        if (wrapper.hasAttribute('data-table-initialized')) return;
        wrapper.setAttribute('data-table-initialized', 'true');

        var table = wrapper.querySelector('table');
        var tbody = table && table.querySelector('tbody');
        var thead = table && table.querySelector('thead');
        var filterInput = wrapper.querySelector('[data-table-filter]');

        if (wrapper.getAttribute('data-table-sortable') === 'true' && thead && tbody) {
          thead.querySelectorAll('th[data-sortable="true"] button.table__sort-trigger').forEach(function(btn) {
            var th = btn.closest('th');
            var colIndex = parseInt(th.getAttribute('data-column-index'), 10);
            btn.addEventListener('click', function() { sortTable(tbody, colIndex, th); });
          });
        }

        if (wrapper.getAttribute('data-table-filterable') === 'true' && filterInput && tbody) {
          filterInput.addEventListener('input', function() {
            var q = (filterInput.value || '').trim().toLowerCase();
            tbody.querySelectorAll('tr').forEach(function(tr) {
              var text = Array.from(tr.querySelectorAll('td')).map(function(td) { return td.textContent || ''; }).join(' ').toLowerCase();
              tr.hidden = q ? text.indexOf(q) === -1 : false;
            });
          });
        }
      });

      function sortTable(tbody, colIndex, th) {
        var type = th.getAttribute('data-type') || 'string';
        var dir = th.getAttribute('aria-sort') === 'ascending' ? 'descending' : 'ascending';
        var rows = Array.from(tbody.querySelectorAll('tr'));

        rows.sort(function(a, b) {
          var aCell = a.querySelectorAll('td')[colIndex];
          var bCell = b.querySelectorAll('td')[colIndex];
          var aVal = aCell ? aCell.textContent : '';
          var bVal = bCell ? bCell.textContent : '';
          if (type === 'number') {
            var aNum = parseFloat(String(aVal).replace(/[^0-9.-]/g, '')) || 0;
            var bNum = parseFloat(String(bVal).replace(/[^0-9.-]/g, '')) || 0;
            return dir === 'ascending' ? aNum - bNum : bNum - aNum;
          }
          var cmp = String(aVal).localeCompare(String(bVal), undefined, { numeric: true });
          return dir === 'ascending' ? cmp : -cmp;
        });

        th.setAttribute('aria-sort', dir);
        var table = tbody.parentNode;
        if (table && table.querySelector) {
          table.querySelectorAll('thead th[data-sortable="true"]').forEach(function(h) {
            if (h !== th) h.setAttribute('aria-sort', 'none');
          });
        }
        rows.forEach(function(tr) { tbody.appendChild(tr); });
      }
    }
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init);
    else init();
    document.addEventListener('astro:page-load', function() { setTimeout(init, 0); });
  })();
</script>

<style>
  .example { margin: var(--spacing-6) 0; padding: var(--spacing-4); background: var(--background-alt); border: 1px solid var(--border); border-radius: var(--radius-lg); }
  .example-title { font-size: var(--font-size-sm); font-weight: var(--font-weight-medium); color: var(--text-dim); margin-bottom: var(--spacing-3); text-transform: uppercase; letter-spacing: var(--letter-spacing-wider); }
</style>

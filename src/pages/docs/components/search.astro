---
import DocsLayout from '../../../layouts/DocsLayout.astro';
import SearchComponent from '../../../components/Search.astro';
import CodeBlock from '../../../components/CodeBlock.astro';
import AddComponentTabs from '../../../components/AddComponentTabs.astro';
import FrameworkCodeTabs from '../../../components/FrameworkCodeTabs.astro';
---

<DocsLayout title="Search Component — Astro" description="Search component with Algolia integration and live filtering">
	<section>
		<h2>Search Component</h2>
		<p>An accessible search component with Algolia integration for fast, relevant search results. Includes live filtering, keyboard navigation, and a client-side fallback. The <strong>package scaffold</strong> (when you add Search via the CLI) ships a minimal version: overlay with header (search icon, input, close button), focus trap, click-outside and Escape to close, and example result links you can edit.</p>
		<AddComponentTabs componentName="Search" />
	</section>
	
	<section>
		<h2>Features</h2>
		<ul>
			<li><strong>Full-screen overlay</strong> - When open, the overlay covers the viewport; the search modal is centered inside it both horizontally and vertically</li>
			<li>Algolia integration with client-side fallback</li>
			<li>Keyboard shortcut - <kbd>Ctrl+K</kbd> / <kbd>Cmd+K</kbd> to open</li>
			<li>Close button on desktop (X icon with screen reader label)</li>
			<li>Close button on mobile with text label</li>
			<li>Live search results as you type</li>
			<li>Full keyboard navigation (Arrow keys, Enter, Escape, Tab)</li>
			<li>Mobile responsive - Full-width panel on mobile</li>
			<li>Mutually exclusive with mobile menu (only one open at a time)</li>
			<li>Accessible - ARIA attributes and screen reader support</li>
		</ul>
	</section>
	
	<section>
		<h2>Live example</h2>
		<p>Search is in the navbar (top of page) — click the search icon or press <kbd>Ctrl+K</kbd> / <kbd>Cmd+K</kbd>. You can also use the standalone search below.</p>
		<div class="example">
			<div class="example-title">Standalone search (same as navbar)</div>
			<div class="search-doc-example">
				<SearchComponent />
			</div>
		</div>
	</section>
	
	<section>
		<h2>Usage</h2>
		<p>Search script runs after DOM ready. Ctrl+K / Cmd+K opens it when the component is on the page.</p>
		<FrameworkCodeTabs
			astro={`---
import Search from '../components/rizzo/Search.astro';
---

<Search id="search-main" />

<!-- With Algolia: useAlgolia={true} algoliaAppId="..." algoliaApiKey="..." algoliaIndexName="..." -->`}
			svelte={`<script>
  import { Search } from '$lib/rizzo';
</script>

<Search id="search-main" />`}
			vanilla={`<!-- Shipped Navbar includes Search; standalone below. Include js/main.js for open/close, focus trap, click-outside. -->
<div class="search" data-search>
  <div class="search__trigger-wrapper">
    <button type="button" class="search__trigger" aria-label="Open search" aria-expanded="false" aria-controls="search-panel">
      <span class="search__trigger-text">Search</span>
    </button>
  </div>
  <div class="search__overlay" id="search-panel" aria-hidden="true" role="dialog" aria-modal="true" data-search-overlay>
    <div class="search__panel">
      <input type="search" class="search__input" placeholder="Search…" aria-label="Search" />
      <div class="search__results" role="listbox" aria-label="Search results">
        <div class="search__empty">
          <p class="search__empty-text">Start typing to search…</p>
        </div>
        <div class="search__results-list" role="group" aria-label="Sample results">
          <a href="#" class="search__result-item" tabindex="-1"><div class="search__result-category">Docs</div><div class="search__result-title">Getting started</div></a>
          <a href="#" class="search__result-item" tabindex="-1"><div class="search__result-category">Docs</div><div class="search__result-title">Components</div></a>
          <a href="#" class="search__result-item" tabindex="-1"><div class="search__result-category">Docs</div><div class="search__result-title">Theming</div></a>
        </div>
      </div>
    </div>
  </div>
</div>`}
		/>
	</section>
	
	<section>
		<h2>Props</h2>
		<ul>
			<li><code>useAlgolia</code> (boolean, optional) - Enable Algolia search (default: <code>false</code>)</li>
			<li><code>algoliaAppId</code> (string, optional) - Algolia Application ID</li>
			<li><code>algoliaApiKey</code> (string, optional) - Algolia Search-Only API Key</li>
			<li><code>algoliaIndexName</code> (string, optional) - Algolia index name (default: <code>"rizzo-css-docs"</code>)</li>
		</ul>
	</section>
	
	<section>
		<h2>Keyboard Shortcuts</h2>
		<ul>
			<li><kbd>Ctrl+K</kbd> / <kbd>Cmd+K</kbd> - Open/close search</li>
			<li><kbd>Escape</kbd> - Close search</li>
			<li><kbd>Arrow Down</kbd> - Navigate to next result</li>
			<li><kbd>Arrow Up</kbd> - Navigate to previous result</li>
			<li><kbd>Enter</kbd> - Navigate to selected result</li>
		</ul>
	</section>
	
	<section>
		<h2>Algolia Setup</h2>
		<p>To use Algolia search in production:</p>
		<ol>
			<li>Create an account at <a href="https://www.algolia.com/" target="_blank" rel="noopener noreferrer">algolia.com</a></li>
			<li>Create a new application and get your credentials</li>
			<li>Index your documentation using the indexing script:
				<CodeBlock code={`# Install Algolia client
pnpm add algoliasearch

# Set environment variables
export ALGOLIA_APP_ID="your-app-id"
export ALGOLIA_API_KEY="your-admin-api-key"
export ALGOLIA_INDEX_NAME="rizzo-css-docs"

# Run indexing script
node scripts/index-docs.js`} language="bash" />
			</li>
			<li>Configure your Search component with the credentials</li>
		</ol>
		<p>See <a href="/docs/search">Search Documentation</a> for complete setup instructions.</p>
	</section>
	
	<section>
		<h2>Accessibility</h2>
		<p>The Search component includes comprehensive accessibility features:</p>
		<ul>
			<li><strong>ARIA Roles:</strong> <code>role="dialog"</code>, <code>role="listbox"</code>, <code>role="option"</code></li>
			<li><strong>ARIA Labels:</strong> Descriptive labels for all interactive elements</li>
			<li><strong>Keyboard Navigation:</strong> Full keyboard support for all interactions</li>
			<li><strong>Focus Management:</strong> Focus trapping and restoration</li>
			<li><strong>Screen Reader Support:</strong> Proper announcements and labels</li>
			<li><strong>Live Regions:</strong> Search results announced to screen readers</li>
		</ul>
		<p><strong>Svelte & Vanilla:</strong> <a href="/docs/svelte/components/search">Svelte</a> · Vanilla: same HTML and BEM as in Usage above; add JS for Cmd+K and Algolia.</p>
	</section>
</DocsLayout>

<style>
	/* Search trigger matches navbar size (base .search__trigger already has same padding/min) */
	.search-doc-example {
		display: flex;
		align-items: center;
		gap: var(--spacing-4);
	}
	@media (width <= 1023px) {
		.search-doc-example .search__trigger {
			width: auto;
			justify-content: center;
		}
		.search-doc-example .search__trigger-text,
		.search-doc-example .search__kbd {
			position: absolute;
			width: 1px;
			height: 1px;
			padding: 0;
			margin: -1px;
			overflow: hidden;
			clip-path: inset(50%);
			white-space: nowrap;
			border: 0;
		}
	}
	kbd {
		display: inline-block;
		padding: var(--spacing-0-125) var(--spacing-0-375);
		background-color: var(--background-alt);
		border: var(--outline-width) solid var(--border);
		border-radius: var(--radius);
		font-family: var(--font-family-mono);
		font-size: var(--font-size-xs);
		line-height: 1;
	}
</style>

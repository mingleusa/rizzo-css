---
import DocsLayout from '../../../layouts/DocsLayout.astro';
import SvelteDocPage from '../../../components/svelte/docs/SvelteDocPage.svelte';
import Search from '../../../components/Search.astro';

export function getStaticPaths() {
  const paths: { params: { slug: string } }[] = [
    { params: { slug: 'components' } },
    { params: { slug: 'components/button' } },
    { params: { slug: 'components/back-to-top' } },
    { params: { slug: 'components/badge' } },
    { params: { slug: 'components/cards' } },
    { params: { slug: 'components/divider' } },
    { params: { slug: 'components/spinner' } },
    { params: { slug: 'components/progress-bar' } },
    { params: { slug: 'components/avatar' } },
    { params: { slug: 'components/alert' } },
    { params: { slug: 'components/breadcrumb' } },
    { params: { slug: 'components/forms' } },
    { params: { slug: 'components/copy-to-clipboard' } },
    { params: { slug: 'components/tooltip' } },
    { params: { slug: 'components/pagination' } },
    { params: { slug: 'components/tabs' } },
    { params: { slug: 'components/accordion' } },
    { params: { slug: 'components/dropdown' } },
    { params: { slug: 'components/modal' } },
    { params: { slug: 'components/toast' } },
    { params: { slug: 'components/table' } },
    { params: { slug: 'components/icons' } },
    { params: { slug: 'components/navbar' } },
    { params: { slug: 'components/search' } },
    { params: { slug: 'components/settings' } },
    { params: { slug: 'components/theme-switcher' } },
    { params: { slug: 'components/font-switcher' } },
    { params: { slug: 'components/sound-effects' } },
    { params: { slug: 'components/docs-sidebar' } },
    { params: { slug: 'components/footer' } },
  ];
  return paths;
}

const slugParam = Astro.params.slug as string | undefined;
const path = slugParam ? slugParam.split('/').filter(Boolean) : [];

function getMeta() {
  if (path[0] === 'components' && !path[1]) return { title: 'Components — Svelte', description: 'Svelte component library.' };
  const titles: Record<string, string> = {
    button: 'Button',
    'back-to-top': 'Back to Top',
    badge: 'Badge',
    cards: 'Cards',
    divider: 'Divider',
    spinner: 'Spinner',
    'progress-bar': 'Progress Bar',
    avatar: 'Avatar',
    alert: 'Alert',
    breadcrumb: 'Breadcrumb',
    forms: 'Forms',
    'copy-to-clipboard': 'Copy to Clipboard',
    tooltip: 'Tooltip',
    pagination: 'Pagination',
    tabs: 'Tabs',
    accordion: 'Accordion',
    dropdown: 'Dropdown',
    modal: 'Modal',
    toast: 'Toast',
    table: 'Table',
    icons: 'Icons',
    navbar: 'Navbar',
    search: 'Search',
    settings: 'Settings',
    'theme-switcher': 'Theme Switcher',
    'font-switcher': 'Font Switcher',
    'sound-effects': 'Sound Effects',
    'docs-sidebar': 'Docs Sidebar',
    footer: 'Footer',
  };
  const name = path[1] ? titles[path[1]] ?? path[1].replace(/-/g, ' ').replace(/\b\w/g, (c) => c.toUpperCase()) : 'Components';
  return { title: path[1] ? `${name} — Svelte` : name, description: `${name} component — Svelte.` };
}

const { title, description } = getMeta();
---

<DocsLayout title={title} description={description}>
  {slugParam === 'components/search' && (
    <section class="search-doc-live">
      <h2>Live example</h2>
      <p>Search is in the navbar (top of page) — click the search icon or press <kbd>Ctrl+K</kbd> / <kbd>Cmd+K</kbd>. You can also use the standalone search below.</p>
      <div class="example">
        <div class="example-title">Standalone search (same as navbar)</div>
        <div class="search-doc-example">
          <Search />
        </div>
      </div>
    </section>
  )}
  <SvelteDocPage slug={slugParam} client:load />
</DocsLayout>

{slugParam === 'components/search' && (
  <style>
    .search-doc-live .search-doc-example {
      display: flex;
      align-items: center;
      gap: var(--spacing-4);
    }
    @media (width <= 1023px) {
      .search-doc-live .search-doc-example .search__trigger-text,
      .search-doc-live .search-doc-example .search__kbd {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip-path: inset(50%);
        white-space: nowrap;
        border: 0;
      }
    }
  </style>
)}

---
import ChevronDown from './icons/ChevronDown.astro';

interface BreadcrumbItem {
  label: string;
  href?: string;
}

interface Props {
  items: BreadcrumbItem[];
  separator?: 'chevron' | 'slash' | 'arrow' | string;
  class?: string;
}

const {
  items,
  separator = 'chevron',
  class: className = '',
} = Astro.props;

const separatorVariant =
  separator === 'slash' ? 'breadcrumb--slash' :
  separator === 'arrow' ? 'breadcrumb--arrow' :
  'breadcrumb--chevron';
const classes = `breadcrumb ${separatorVariant} ${className}`.trim();

const separatorChar = separator === 'slash' ? '/' : separator === 'arrow' ? '›' : typeof separator === 'string' ? separator : null;
const useIcon = separator === 'chevron';
---

<nav class={classes} aria-label="Breadcrumb">
  <ol class="breadcrumb__list">
    {items.map((item, index) => {
      const isLast = index === items.length - 1;
      const isCurrent = isLast || !item.href;

      return (
        <li class={`breadcrumb__item ${isCurrent ? 'breadcrumb__item--current' : ''}`}>
          {isCurrent ? (
            <span class="breadcrumb__current" aria-current="page">
              {item.label}
            </span>
          ) : (
            <a class="breadcrumb__link" href={item.href}>
              {item.label}
            </a>
          )}
          {!isLast && (
            <span class="breadcrumb__separator" aria-hidden="true">
              {useIcon ? (
                <ChevronDown class="breadcrumb__separator-icon" width={14} height={14} />
              ) : (
                separatorChar ?? '›'
              )}
            </span>
          )}
        </li>
      );
    })}
  </ol>
</nav>
